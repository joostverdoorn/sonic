!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n;n="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,n.Sonic=e()}}(function(){return function e(n,t,r){function u(o,a){if(!t[o]){if(!n[o]){var f="function"==typeof require&&require;if(!a&&f)return f(o,!0);if(i)return i(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var s=t[o]={exports:{}};n[o][0].call(s.exports,function(e){var t=n[o][1][e];return u(t?t:e)},s,s.exports,e,n,t,r)}return t[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)u(r[o]);return u}({1:[function(e,n,t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var u,i=function(){function e(e,n){var t=[],r=!0,u=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(r=(o=a.next()).done)&&(t.push(o.value),!n||t.length!==n);r=!0);}catch(f){u=!0,i=f}finally{try{!r&&a["return"]&&a["return"]()}finally{if(u)throw i}}return t}return function(n,t){if(Array.isArray(n))return n;if(Symbol.iterator in Object(n))return e(n,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=e("./key"),a=r(o);t.AsyncIterator=u,function(e){function n(e,n){function t(){return e.next().then(function(e){return e.done?!0:Promise.resolve(n(e.value)).then(function(e){return e?t():!1})})}return t()}function t(e,t){return n(e,function(e){return Promise.resolve(t(e)).then(function(e){return!e})}).then(function(e){return!e})}function r(e,t){return n(e,function(e){return Promise.resolve(t(e)).then(function(){return!0})}).then(function(){})}function u(e,n,t){return r(e,function(e){return Promise.resolve(n(t,e)).then(function(e){t=e})}).then(function(){return t})}function o(e,n){var r;return t(e,function(e){return Promise.resolve(n(e)).then(function(n){return n?(r=e,!0):!1})}).then(function(e){return e?r:a["default"].NOT_FOUND})}function f(e,n){var r=-1;return t(e,function(e){return r++,n==e}).then(function(e){return e?r:a["default"].NOT_FOUND})}function l(e,n){return o(e,function(){return 0===n--})}function s(e,n){return t(e,function(e){return e===n})}function c(n,t){var r=arguments.length<=2||void 0===arguments[2]?function(e,n){return e===n}:arguments[2];return e.every(n,function(e){return t.next().then(function(n){return!n.done&&r(n.value,e)})}).then(function(e){return e?t.next().then(function(e){return e.done}):!1})}function d(n,t){return{next:function(){return n.next().then(function(n){return n.done?Promise.resolve(e.sentinel):Promise.resolve(t(n.value)).then(function(e){return{done:!1,value:e}})})}}}function v(e,n){function t(){return e.next().then(function(e){return e.done?e:Promise.resolve(n(e.value)).then(function(n){return n?e:t()})})}return{next:t}}function p(n,t,r){return{next:function(){return n.next().then(function(n){return n.done?Promise.resolve(e.sentinel):Promise.resolve(t(r,n.value)).then(function(e){return{done:!1,value:r=e}})})}}}function m(n,t){return{next:function(){return Promise.all([n.next(),t.next()]).then(function(n){var t=i(n,2),r=t[0],u=t[1];return r.done||u.done?e.sentinel:{done:!1,value:[r.value,u.value]}})}}}function g(){for(var n=arguments.length,t=Array(n),r=0;n>r;r++)t[r]=arguments[r];return t.reduce(function(e,n){var t=!1,r=Promise.resolve(null);return{next:function(){return r=r.then(function(){},function(){}).then(function(){return t?n.next():e.next().then(function(e){return e.done?(t=!0,n.next()):e})})}}},e.Empty)}function h(n){var t=-1,r=Promise.resolve(null);return{next:function(){return r=r.then(function(){},function(){}).then(function(){return Promise.resolve(++t>=n.length?e.sentinel:{done:!1,value:n[t]})})}}}function P(e){return h(Object.keys(e).map(function(n){return[n,e[n]]}))}function x(e){return u(e,function(e,n){return e.push(n),e},[])}function b(e){return u(e,function(e,n){var t=i(n,2),r=t[0],u=t[1];return e[r]=u,e},Object.create(null))}e.sentinel={done:!0},e.Empty={next:function(){return Promise.resolve(e.sentinel)}},e.every=n,e.some=t,e.forEach=r,e.reduce=u,e.find=o,e.indexOf=f,e.at=l,e.contains=s,e.is=c,e.map=d,e.filter=v,e.scan=p,e.zip=m,e.concat=g,e.fromArray=h,e.fromObject=P,e.toArray=x,e.toObject=b}(u||(t.AsyncIterator=u={})),t["default"]=u},{"./key":4}],2:[function(e,n,t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var u,i=e("./key"),o=r(i);t.Cache=u,function(e){function n(){return{get:Object.create(null),prev:Object.create(null),next:Object.create(null)}}function t(e){return{get:Object.create(e.get),prev:Object.create(e.prev),next:Object.create(e.next)}}function r(e,n){function t(t){return t in n.get?n.get[t]:n.get[t]=e.get(t)}function r(){var t=arguments.length<=0||void 0===arguments[0]?o["default"].sentinel:arguments[0];return t in n.prev?n.prev[t]:n.prev[t]=e.prev(t).then(function(e){return n.next[e]=Promise.resolve(t),e})}function u(){var t=arguments.length<=0||void 0===arguments[0]?o["default"].sentinel:arguments[0];return t in n.next?n.next[t]:n.next[t]=e.next(t).then(function(e){return n.prev[e]=Promise.resolve(t),e})}return{get:t,prev:r,next:u}}e.create=n,e.extend=t,e.apply=r}(u||(t.Cache=u={})),t["default"]=u},{"./key":4}],3:[function(e,n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;t.Entry=r,function(e){function n(e){return e&&e[0]}function t(e){return e[1]}function r(e,n){return e[0]===n[0]&&e[1]===n[1]}e.key=n,e.value=t,e.is=r}(r||(t.Entry=r={})),t["default"]=r},{}],4:[function(e,n,t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var u,i=e("./promise_utils"),o=r(i);!function(e){function n(e){return e.toString()}function t(){return r++}e.NOT_FOUND_ERROR=new Error("No entry at the specified key"),e.NOT_FOUND=o["default"].lazy(function(n,t){return t(e.NOT_FOUND_ERROR)}),e.sentinel=null;var r=0;e.key=n,e.create=t}(u||(u={})),t["default"]=u,n.exports=t["default"]},{"./promise_utils":9}],5:[function(e,n,t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var u,i=e("./state"),o=r(i),a=e("./list"),f=e("./observable");t.Lens=u,function(e){function n(e,n){var t=f.Subject.create(),r=f.Subject.create();return f.Observable.map(e.patches,function(e){return e.added?{range:e.range,added:o["default"].map(e.added,n.get)}:{range:e.range}}).subscribe(t),f.Observable.map(r,function(e){return e.added?{range:e.range,added:o["default"].map(e.added,n.set)}:{range:e.range}}).subscribe(e.patches),a.List.create(o["default"].map(e.state,n.get),{subscribe:t.subscribe,onNext:r.onNext})}e.compose=n}(u||(t.Lens=u={})),t["default"]=u},{"./list":6,"./observable":7,"./state":12}],6:[function(e,n,t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var u,i=e("./key"),o=r(i),a=e("./patch"),f=r(a),l=e("./state"),s=r(l),c=e("./range"),d=e("./tree"),v=e("./observable"),p=e("./async_iterator"),m=r(p);t.List=u,function(e){function n(e,n){var t=s["default"].map(e.state,n),r=v.Observable.map(e.patches,function(e){return{range:e.range,added:e.added?s["default"].map(e.added,n):void 0}});return l(t,r)}function t(e,n){var t=s["default"].filter(e.state,n),r=v.Observable.map(e.patches,function(e){return Promise.all([m["default"].find(s["default"].entries(s["default"].reverse(t),[c.Position.reverse(e.range[0]),{prev:null}]),function(e){return n(e[1],e[0])}).then(function(e){return{next:e[0]}}),m["default"].find(s["default"].entries(t,[e.range[1],{prev:null}]),function(e){return n(e[1],e[0])}).then(function(e){return{prev:e[0]}})]).then(function(t){return{range:t,added:e.added?s["default"].filter(e.added,n):void 0}})});return l(t,r,function(e,n){return t=f["default"].apply(e,n)})}function r(e,n){var t=e.state,r=s["default"].zoom(e.state,n),u=v.Observable.map(v.Observable.filter(e.patches,function(e){return m["default"].some(s["default"].entries(t,e.range),function(e){return e[0]===n}).then(function(t){return e.added?s["default"].has(e.added,n):t})}),function(r){return t=e.state,{range:c.Range.all,added:r.added?s["default"].zoom(r.added,n):void 0}});return l(r,u)}function u(e){var t=v.Subject.create(),r=a(n(e,function(e,n){return v.Observable.map(e.patches,function(t){function r(t){return t.prev===o["default"].sentinel?e.state.prev(o["default"].sentinel).then(function(e){return{next:d.Path.toKey([n,e])}}):Promise.resolve({prev:d.Path.toKey([n,t.prev])})}function u(t){return t.next===o["default"].sentinel?e.state.next(o["default"].sentinel).then(function(e){return{prev:d.Path.toKey([n,e])}}):Promise.resolve({next:d.Path.toKey([n,t.next])})}var i=t.range[0],a=t.range[1];return Promise.all([c.Position.isNextPosition(i)?u(i):r(i),c.Position.isNextPosition(a)?u(a):r(a)]).then(function(e){return{range:e,added:t.added?t.added:void 0}})}).subscribe(t),e.state}));v.Observable.map(e.patches,function(e){function n(e){return e.prev===o["default"].sentinel?Promise.resolve({prev:o["default"].sentinel}):d.Tree.next(r.state,[e.prev]).then(d.Path.toKey).then(function(e){return{prev:e}})}function t(e){return e.next===o["default"].sentinel?Promise.resolve({next:o["default"].sentinel}):d.Tree.prev(r.state,[e.next]).then(d.Path.toKey).then(function(e){return{next:e}})}var u=e.range[0],i=e.range[1];return Promise.all([c.Position.isNextPosition(u)?t(u):n(u),c.Position.isNextPosition(i)?t(i):n(i)]).then(function(n){return{range:n,added:e.added?s["default"].flatten(s["default"].map(e.added,function(e){return e.state})):void 0}})}).subscribe(t);var u=s["default"].flatten(r.state);return l(u,t)}function i(e,n,t){var r,u=s["default"].scan(e.state,n,t),i=v.Observable.map(e.patches,function(t){var u=e.state,i=r.state,o=[t.range[0],{prev:null}],a=s["default"].lazy(function(){return s["default"].last(i,[{next:null},t.range[0]]).then(function(e){return s["default"].scan(s["default"].slice(u,[t.range[0],{prev:null}]),n,e)})});return{range:o,added:a}});return r=l(u,i)}function a(n){var t=s["default"].cache(n.state),r=v.Observable.map(n.patches,function(e){return{range:e.range,added:s["default"].cache(e.added)}});return e.create(t,r)}function l(e,n){var t=arguments.length<=2||void 0===arguments[2]?f["default"].apply:arguments[2],r={state:e,patches:n};return v.Observable.scan(n,t,e).subscribe({onNext:function(e){r.state=e}}),r}e.map=n,e.filter=t,e.zoom=r,e.flatten=u,e.scan=i,e.cache=a,e.create=l}(u||(t.List=u={})),t["default"]=u},{"./async_iterator":1,"./key":4,"./observable":7,"./patch":8,"./range":10,"./state":12,"./tree":13}],7:[function(e,n,t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var u,i=e("./key"),o=r(i);t.Disposable=u,function(e){function n(e){var n=!1;return{dispose:function(){n||(n=!0,e())}}}e.create=n}(u||(t.Disposable=u={}));var a;t.Observable=a,function(e){function n(e,n){var t=f.create();return e.subscribe({onNext:function(e){return Promise.resolve(n(e)).then(t.onNext)}}),{subscribe:t.subscribe}}function t(e,n){var t=f.create();return e.subscribe({onNext:function(e){return Promise.resolve(n(e)).then(function(n){return n?t.onNext(e):void 0})}}),{subscribe:t.subscribe}}function r(e,n,t){var r=f.create();return e.subscribe({onNext:function(e){return Promise.resolve(n(t,e)).then(function(e){t=e,r.onNext(e)})}}),{subscribe:r.subscribe}}e.map=n,e.filter=t,e.scan=r}(a||(t.Observable=a={}));var f;t.Subject=f,function(e){function n(){function e(e){var n=o["default"].create();return t[n]=e,u.create(function(){return delete t[n]})}function n(e){return r=r.then(function(){return Promise.all(Object.keys(t).map(function(n){return t[n].onNext(e)})).then(function(){})})}var t=Object.create(null),r=Promise.resolve();return{subscribe:e,onNext:n}}e.create=n}(f||(t.Subject=f={}))},{"./key":4}],8:[function(e,n,t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var u,i=e("./state"),o=r(i);t.Patch=u,function(e){function n(e,n){return o["default"].splice(e,n.range,n.added)}e.apply=n}(u||(t.Patch=u={})),t["default"]=u},{"./state":12}],9:[function(e,n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;t.PromiseUtils=r,function(e){function n(e){function n(n,r){return t?t.then(n,r):(t=new Promise(e)).then(n,r)}var t;return Promise.resolve({then:n})}e.lazy=n}(r||(t.PromiseUtils=r={})),t["default"]=r},{}],10:[function(e,n,t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var u,i=e("./key"),o=r(i);t.Range=u,function(e){e.all=[{next:o["default"].sentinel},{prev:o["default"].sentinel}]}(u||(t.Range=u={}));var a;t.Position=a,function(e){function n(e){return"prev"in e}function t(e){return"next"in e}function r(n){return e.isPrevPosition(n)?{next:n.prev}:{prev:n.next}}e.isPrevPosition=n,e.isNextPosition=t,e.reverse=r}(a||(t.Position=a={})),t["default"]=u},{"./key":4}],11:[function(e,n,t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function u(e){return e instanceof Array?l.List.create(o["default"].fromArray(e),p.Subject.create()):e instanceof Object?l.List.create(o["default"].fromObject(e),p.Subject.create()):void 0}Object.defineProperty(t,"__esModule",{value:!0}),t.Sonic=u;var u,i=e("./state"),o=r(i),a=e("./async_iterator"),f=r(a),l=e("./list"),s=e("./tree"),c=r(s),d=e("./cache"),v=r(d),p=e("./observable"),m=e("./promise_utils"),g=r(m),h=e("./lens"),P=r(h);t.Sonic=u,function(e){e.State=o["default"],e.AsyncIterator=f["default"],e.List=l.List,e.Tree=c["default"],e.Subject=p.Subject,e.Cache=v["default"],e.PromiseUtils=g["default"],e.Lens=P["default"]}(u||(t.Sonic=t.Sonic=u={})),n.exports=u,t["default"]=u},{"./async_iterator":1,"./cache":2,"./lens":5,"./list":6,"./observable":7,"./promise_utils":9,"./state":12,"./tree":13}],12:[function(e,n,t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var u,i=function(){function e(e,n){var t=[],r=!0,u=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(r=(o=a.next()).done)&&(t.push(o.value),!n||t.length!==n);r=!0);}catch(f){u=!0,i=f}finally{try{!r&&a["return"]&&a["return"]()}finally{if(u)throw i}}return t}return function(n,t){if(Array.isArray(n))return n;if(Symbol.iterator in Object(n))return e(n,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=e("./key"),a=r(o),f=e("./entry"),l=r(f),s=e("./range"),c=e("./cache"),d=r(c),v=e("./async_iterator"),p=r(v),m=e("./tree"),g=e("./promise_utils"),h=r(g);t.State=u,function(e){function n(e,n){var t=n.get,r=n.prev,u=n.next,i=Object.create(e);return t&&(i.get=t),r&&(i.prev=r),u&&(i.next=u),i}function t(e){var n=arguments.length<=1||void 0===arguments[1]?s.Range.all:arguments[1],t=i(n,2),r=t[0];t[1];return s.Position.isPrevPosition(r)?e.get(r.prev):e.next(r.next).then(e.get)}function r(e){var n=arguments.length<=1||void 0===arguments[1]?s.Range.all:arguments[1],t=i(n,2),r=(t[0],t[1]);return s.Position.isNextPosition(r)?e.get(r.next):e.prev(r.prev).then(e.get)}function u(e,n){return e.get(n).then(function(){return!0},function(e){return e===a["default"].NOT_FOUND_ERROR?!1:Promise.reject(e)})}function o(e,n){var t=M(e),r=M(n);return p["default"].is(t,r,l["default"].is)}function f(e,n){return p["default"].some(M(e),function(e){return e[1]===n})}function c(e){return e.next().then(function(e){return e===a["default"].sentinel})}function v(e){var n=arguments.length<=1||void 0===arguments[1]?s.Range.all:arguments[1];return D(M(e,n))}function g(e,t,r){function i(e){return u(r,e).then(function(n){return n?d.get(e):p.get(e)})}function o(){var e=arguments.length<=0||void 0===arguments[0]?a["default"].sentinel:arguments[0];return s.Position.isPrevPosition(g)&&e===g.prev?d.prev(a["default"].sentinel):u(d,e).then(function(n){return n?d.prev(e):p.prev(e)})}function f(){var e=arguments.length<=0||void 0===arguments[0]?a["default"].sentinel:arguments[0];return s.Position.isNextPosition(m)&&e===m.next?d.next(a["default"].sentinel):u(d,e).then(function(n){return n?d.next(e):p.next(e)})}var l=v(e,t),c=b(e,function(e,n){return l.get(n).then(function(){return!1},function(){return!0})});if(null==r)return c;var d,p,m=t[0],g=t[1];return d=n(r,{prev:function(n){return r.prev(n).then(function(n){return n!==a["default"].sentinel?Promise.resolve(n):s.Position.isNextPosition(m)?Promise.resolve(m.next):e.prev(m.prev)})},next:function(n){return r.next(n).then(function(n){return n!==a["default"].sentinel?Promise.resolve(n):s.Position.isPrevPosition(g)?Promise.resolve(g.prev):e.next(g.next)})}}),p=n(c,{prev:function(n){return e.prev(n).then(function(e){return s.Position.isNextPosition(g)&&e===g.next?d.prev(a["default"].sentinel):u(l,e).then(function(n){return n?a["default"].NOT_FOUND:e})})},next:function(n){return e.next(n).then(function(e){return s.Position.isPrevPosition(m)&&e===m.prev?d.next(a["default"].sentinel):u(l,e).then(function(n){return n?a["default"].NOT_FOUND:e})})}}),{get:i,prev:o,next:f}}function P(e){return n(e,{prev:e.next,next:e.prev})}function x(e,t){return n(e,{get:function(n){return e.get(n).then(function(e){return t(e,n)})}})}function b(e,t){function r(n){return n in f?f[n]:f[n]=e.get(n).then(function(e){return t(e,n)})}function u(n){return r(n).then(function(t){return t?e.get(n):a["default"].NOT_FOUND})}function i(n){return e.prev(n).then(function(e){return e===a["default"].sentinel?a["default"].sentinel:r(e).then(function(n){return n?e:i(e)})})}function o(n){return e.next(n).then(function(e){return e===a["default"].sentinel?a["default"].sentinel:r(e).then(function(n){return n?e:o(e)})})}var f=Object.create(null);return n(e,{get:u,prev:i,next:o})}function y(e,n,t){return D(p["default"].scan(M(e),function(e,t){return Promise.resolve(n(e[1],t[1],t[0])).then(function(e){return[t[0],e]})},[a["default"].sentinel,t]))}function O(e,n){return k(p["default"].zip(U(e),U(n)))}function _(e,t){var r=function(){var n=arguments.length<=0||void 0===arguments[0]?a["default"].sentinel:arguments[0];return n===a["default"].sentinel?e.get(t).then(function(){return t},function(e){return e===a["default"].NOT_FOUND_ERROR?a["default"].sentinel:Promise.reject(e)}):t===n?Promise.resolve(a["default"].sentinel):a["default"].NOT_FOUND};return n(e,{get:function(n){return n===t?e.get(t):a["default"].NOT_FOUND},prev:r,next:r})}function N(e){return n(e,{get:function(n){return m.Tree.get(e,m.Path.fromKey(n))},prev:function(n){return m.Tree.prev(e,m.Path.fromKey(n)).then(m.Path.toKey)},next:function(n){return m.Tree.next(e,m.Path.fromKey(n)).then(m.Path.toKey)}})}function j(e,n){return D(p["default"].map(M(e),function(e){return Promise.resolve(n(e[1],e[0])).then(function(n){return[n,e[1]]})}))}function T(e){return d["default"].apply(e,d["default"].create())}function M(e){var n=arguments.length<=1||void 0===arguments[1]?s.Range.all:arguments[1],t=a["default"].sentinel,r=!1,u=n[0],i=n[1];return{next:function(){function n(n){return n===a["default"].sentinel?(r=!0,Promise.resolve(p["default"].sentinel)):e.get(n).then(function(e){return t=n,{done:!1,value:[n,e]}})}function o(t){return e.next(t).then(function(e){return n(s.Position.isPrevPosition(i)&&i.prev===e?a["default"].sentinel:e)})}return s.Position.isPrevPosition(u)&&s.Position.isPrevPosition(i)&&u.prev===i.prev?n(a["default"].sentinel):s.Position.isNextPosition(u)&&s.Position.isNextPosition(i)&&u.next===i.next?n(a["default"].sentinel):t===a["default"].sentinel?s.Position.isPrevPosition(u)?n(u.prev):o(u.next):s.Position.isNextPosition(i)&&i.next===t?n(a["default"].sentinel):o(t)}}}function S(e){var n=arguments.length<=1||void 0===arguments[1]?s.Range.all:arguments[1];return p["default"].map(M(e,n),l["default"].key)}function U(e){var n=arguments.length<=1||void 0===arguments[1]?s.Range.all:arguments[1];return p["default"].map(M(e,n),l["default"].value)}function D(e){function n(e){return i?a["default"].NOT_FOUND:p["default"].find(f,function(n){return n[0]===e}).then(l["default"].value)}function t(e){return i?a["default"].NOT_FOUND:p["default"].some(f,function(n){return n[0]===e}).then(function(){return e in u.prev?u.prev[e]:a["default"].NOT_FOUND})}function r(e){return i?a["default"].NOT_FOUND:e===o?f.next().then(function(e){return e.done?a["default"].sentinel:e.value[0]}):p["default"].find(f,function(n){return n[0]===e}).then(function(){return f.next()}).then(function(e){return e.done?a["default"].sentinel:e.value[0]})}var u=d["default"].create(),i=!1,o=null,f=(Promise.resolve(null),{next:function(){return e.next().then(function(e){var n=e.done,t=e.value;return n?(i=!0,u.prev[a["default"].sentinel]=Promise.resolve(o),u.next[o]=Promise.resolve(a["default"].sentinel),p["default"].sentinel):(u.prev[t[0]]=Promise.resolve(o),u.next[o]=Promise.resolve(t[0]),u.get[t[0]]=Promise.resolve(t[1]),o=t[0],{done:n,value:t})})}});return d["default"].apply({get:n,prev:t,next:r},u)}function R(e){return D(p["default"].map(e,function(e){return[e,null]}))}function k(e){return D(p["default"].scan(e,function(e,n){return[e[0]+1,n]},[-1,null]))}function F(e){return k(p["default"].fromArray(e))}function E(e){return D(p["default"].fromObject(e))}function A(e){function n(e){return u?u.get(e):i.then(function(n){return n.get(e)})}function t(e){return u?u.prev(e):i.then(function(n){return n.prev(e)})}function r(e){return u?u.next(e):i.then(function(n){return n.next(e)})}var u,i=h["default"].lazy(function(n,t){return n(Promise.resolve(e()).then(function(e){return u=e}))});return{get:n,prev:t,next:r}}function w(e){var n=arguments.length<=1||void 0===arguments[1]?s.Range.all:arguments[1];return p["default"].toObject(M(e,n))}function K(e){var n=arguments.length<=1||void 0===arguments[1]?s.Range.all:arguments[1];return p["default"].toArray(U(e,n))}e.Empty={get:function(e){return a["default"].NOT_FOUND},prev:function(){var e=arguments.length<=0||void 0===arguments[0]?a["default"].sentinel:arguments[0];return e==a["default"].sentinel?Promise.resolve(a["default"].sentinel):a["default"].NOT_FOUND},next:function(){var e=arguments.length<=0||void 0===arguments[0]?a["default"].sentinel:arguments[0];return e==a["default"].sentinel?Promise.resolve(a["default"].sentinel):a["default"].NOT_FOUND}},e.extend=n,e.first=t,e.last=r,e.has=u,e.is=o,e.contains=f,e.isEmpty=c,e.slice=v,e.splice=g,e.reverse=P,e.map=x,e.filter=b,e.scan=y,e.zip=O,e.zoom=_,e.flatten=N,e.keyBy=j,e.cache=T,e.entries=M,e.keys=S,e.values=U,e.fromEntries=D,e.fromKeys=R,e.fromValues=k,e.fromArray=F,e.fromObject=E,e.lazy=A,e.toObject=w,e.toArray=K}(u||(t.State=u={})),t["default"]=u},{"./async_iterator":1,"./cache":2,"./entry":3,"./key":4,"./promise_utils":9,"./range":10,"./tree":13}],13:[function(e,n,t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var u,i=e("./state"),o=r(i);t.Path=u,function(e){function n(e){return null==e?null:JSON.stringify(e)}function t(e){return null==e?null:e.toString().split("/")}function r(e){return null==e?null:e.join("/")}function u(e){return e?e[0]:null}function i(e,n){return e?e[n]:null}function o(e){return null==e?[]:e.slice(1,e.length)}function a(e,n){return[].concat(e).concat(n)}e.key=n,e.fromKey=t,e.toKey=r,e.head=u,e.get=i,e.tail=o,e.append=a}(u||(t.Path=u={}));var a;t.Tree=a,function(e){function n(e,n){var t=u.get(n,0),r=u.get(n,1);return e.get(t).then(function(e){return e.get(r)})}function t(e,n){var t=u.get(n,0),r=u.get(n,1),i=o["default"].filter(o["default"].map(e,function(e){return e.prev()}),function(e){return null!=e}),a=o["default"].map(i,function(e,n){return[n,e]});return null==t?a.prev().then(function(e){return null!=e?a.get(e):null}):e.get(t).then(function(e){return e.prev(r)}).then(function(e){return null!=e?[t,e]:a.prev(t).then(function(e){return null!=e?a.get(e):null})})}function r(e,n){var t=u.get(n,0),r=u.get(n,1),i=o["default"].filter(o["default"].map(e,function(e){return e.next()}),function(e){return null!=e}),a=o["default"].map(i,function(e,n){return[n,e]});return null==t?a.next().then(function(e){return null!=e?a.get(e):null}):e.get(t).then(function(e){return e.next(r)}).then(function(e){return null!=e?[t,e]:a.next(t).then(function(e){return null!=e?a.get(e):null})})}e.get=n,e.prev=t,e.next=r}(a||(t.Tree=a={})),t["default"]=a},{"./state":12}]},{},[11])(11)});